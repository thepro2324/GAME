<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    <style>body { margin: 0; overflow: hidden; background: #000; }</style>
</head>
<body>
<script>
    const config = {
        type: Phaser.AUTO,
        width: window.innerWidth, // רוחב מסך מלא
        height: window.innerHeight, // גובה מסך מלא
        physics: {
            default: 'arcade',
            arcade: { gravity: { y: 0 }, debug: false } // נוריד כוח משיכה גלובלי ליריות
        },
        scene: { preload: preload, create: create, update: update }
    };

    const game = new Phaser.Game(config);
    let player, cursors, bullets, enemies, score = 0, scoreText;

    function preload() {}

    function create() {
        const w = window.innerWidth;
        const h = window.innerHeight;

        // שמיים על כל המסך
        let sky = this.add.graphics();
        sky.fillGradientStyle(0x000022, 0x000022, 0x111144, 0x111144, 1);
        sky.fillRect(0, 0, w, h);

        // כוכבים
        for (let i = 0; i < 150; i++) {
            this.add.circle(Math.random() * w, Math.random() * h, 1, 0xffffff, Math.random());
        }

        // רצפה
        let ground = this.add.rectangle(w/2, h - 25, w, 50, 0x664422);
        this.physics.add.existing(ground, true);

        // שחקן
        player = this.add.rectangle(w/2, h - 80, 50, 50, 0x00ff00);
        this.physics.add.existing(player);
        player.body.setCollideWorldBounds(true);

        // קבוצות ליריות ואויבים
        bullets = this.physics.add.group();
        enemies = this.physics.add.group();

        // יצירת אויב כל שנייה
        this.time.addEvent({
            delay: 1000,
            callback: spawnEnemy,
            callbackScope: this,
            loop: true
        });

        // טקסט ניקוד
        scoreText = this.add.text(20, 20, 'Score: 0', { fontSize: '32px', fill: '#fff' });

        // התנגשויות
        this.physics.add.overlap(bullets, enemies, hitEnemy, null, this);
        this.physics.add.collider(player, ground);

        cursors = this.input.keyboard.createCursorKeys();
        this.input.keyboard.on('keydown-SPACE', shoot, this);
    }

    function update() {
        if (cursors.left.isDown) player.body.setVelocityX(-400);
        else if (cursors.right.isDown) player.body.setVelocityX(400);
        else player.body.setVelocityX(0);

        // ניקוי אויבים שיצאו מהמסך
        enemies.children.iterate(function (enemy) {
            if (enemy && enemy.y > window.innerHeight) enemy.destroy();
        });
    }

    function shoot() {
        let bullet = this.add.rectangle(player.x, player.y - 30, 8, 20, 0xffff00);
        this.physics.add.existing(bullet);
        bullets.add(bullet);
        bullet.body.setVelocityY(-600);
    }

    function spawnEnemy() {
        let x = Math.random() * window.innerWidth;
        let enemy = this.add.rectangle(x, -50, 40, 40, 0xff0000);
        this.physics.add.existing(enemy);
        enemies.add(enemy);
        enemy.body.setVelocityY(200 + Math.random() * 150);
    }

    function hitEnemy(bullet, enemy) {
        bullet.destroy();
        enemy.destroy();
        score += 10;
        scoreText.setText('Score: ' + score);
    }
</script>
</body>
</html>
